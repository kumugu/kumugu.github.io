---
layout: single
title: "테트리스 게임 만들기 2-1(오류)"
categories: GAME
tag: [TETRIS]
author_profile: false
sidebar:
    nav: "docs"
toc: true
toc_sticky: true
---


## 1. 문제의 원인

이전 내용으로 진행 했으나 블록이 정상적으로 출력되지 않는 문제들이 발생했다. <br/>

```
Live reload enabled.
main.js:20 Uncaught TypeError: Cannot set properties of undefined 
    (setting 'fillStyle')
    at drawTetromino (main.js:20:32)
    at HTMLDocument.<anonymous> (main.js:56:5) 
  
Live reload enabled.
main.js:23 Uncaught ReferenceError: blockSize is not defined
    at drawTetromino (main.js:23:42)
    at HTMLDocument.<anonymous> (main.js:61:5)Understand this error
```

이 오류는 blockSize 변수가 정의되지 않았기 때문에 발생한 것으로 보인다. <br/>
이전 코드에서는 blockSize가 DOMContentLoaded 이벤트 핸들러 내부에 정의되어 있었고, drawTetromino 함수가 호출될 때는 blockSize에 접근할 수 없었다.<br/>

## 2. 문제 발생 코드의 구조
아래는 이전에 작성된 코드다:

```javascript
document.addEventListener("DOMContentLoaded", () => {
    // 게임 보드 크기 설정
    const blockSize = 30; // DOMContentLoaded 이벤트 내부에 정의

    function drawTetromino() {
        // 이 함수는 blockSize를 사용하지만, 외부에서 접근할 수 없어서 오류 발생
        ctx.fillRect((x + col) * blockSize, (y + row) * blockSize, blockSize, blockSize);
    }
});
```

이 구조에서는 blockSize가 DOMContentLoaded 이벤트 핸들러 내부의 지역 변수로 정의되었기 때문에, <br/>
drawTetromino 함수에서 이 변수를 참조할 수 없었다. <br/>
JavaScript에서는 함수 내부에서 정의된 변수는 그 함수 내에서만 접근 가능하기 때문이다.<br/>

## 3. 문제 해결 방법
그래서 blockSize를 전역 변수로 선언하여 DOMContentLoaded 이벤트 핸들러 외부에서도 접근할 수 있도록 수정했다. <br/>
이렇게 하면 모든 함수가 동일한 blockSize 값을 참조할 수 있게 된다.<br/>

```javascript
// 전역 변수로 설정
const blockSize = 30; // 이제 모든 함수가 접근 가능

function drawTetromino() {
    // 이 함수는 전역 변수 blockSize를 참조
    ctx.fillRect((x + col) * blockSize, (y + row) * blockSize, blockSize, blockSize);
}

document.addEventListener("DOMContentLoaded", () => {
    // ctx 초기화 및 그리드 그리기 등 다른 작업 수행
});
```

## 4. 변경된 코드의 구조
전역 변수: blockSize를 전역 변수로 선언하여 모든 함수가 이 값을 참조할 수 있도록 수정.<br/>
drawTetromino 함수에서 전역 변수를 참조: 이제 drawTetromino 함수는 전역에 선언된 blockSize에 접근하여 오류 없이 정상적으로 블록을 그림.

## 5. 해결된 결과
이전에는 drawTetromino 함수가 blockSize에 접근하지 못해 오류가 발생했지만,<br/>
전역 변수로 선언하여 모든 함수가 접근할 수 있도록 수정함으로써 오류 해결.<br/>
이제 테트로미노가 정상적으로 보드에 표시 됨.<br/>
이러한 변경 사항을 통해, **함수와 변수의 범위(scope)**가 코드에서 어떻게 영향을 미치는지 알 수 있고, <br/>
변수를 필요에 따라 적절한 범위에 선언하는 것이 중요함을 이해할 수 있음.<br/>