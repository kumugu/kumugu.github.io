---
layout: single
title: "Spring Bean 스코프"
toc: true
toc_sticky: true
categories: JAVA
tag: [memo]
author_profile: false
sidebar:
    nav: "docs"
---

# Spring Bean 스코프 개요

## 1. 스코프란 무엇인가?
스코프(Scope)는 객체의 **생명주기(lifecycle)와 가용 범위(scope)**를 정의하는 개념이이다.

Spring 프레임워크에서는 **빈(Bean)**이 생성되고 사용되는 범위를 지정하기 위해 다양한 스코프를 제공한한다. 스코프를 통해 빈이 컨테이너에서 몇 번 생성되고 어디에서 사용될지를 제어할 수 있다.

스코프 설정을 통해 애플리케이션의 **메모리 관리 최적화**, **상태 유지를 위한 적절한 객체 관리**, **다양한 요청 및 세션 기반 동작**을 구현할 수 있다.

---

## 2. 스코프의 활용 및 Spring 프레임워크에서의 사용

Spring 프레임워크는 빈의 생명주기를 효율적으로 관리하기 위해 다양한 스코프를 제공합니다. 이러한 스코프를 적용함으로써 애플리케이션의 동작 방식과 리소스 사용을 조정할 수 있다.

### **스코프의 활용 예시**
- 공유해야 하는 객체(`singleton`) → 서비스, DAO 클래스 등에 적용.
- 사용자별 독립적인 객체(`session`) → 로그인 사용자 세션 정보 관리.
- 요청별 별도의 객체(`request`) → 웹 요청마다 새로운 빈 인스턴스 생성.

### **Spring에서 스코프 지정 방법**
스코프는 다음과 같은 방식으로 설정할 수 있습니다.

1. **XML 기반 설정** (빈 설정 파일)

```xml
<bean id="myBean" class="com.example.MyBean" scope="singleton"/>
```

2. **Java 어노테이션 기반 설정**

```java
@Component
@Scope("prototype")
public class MyBean {
}
```

3. **Java Config 클래스 기반 설정**

```java
@Configuration
public class AppConfig {
    @Bean
    @Scope("session")
    public MyBean myBean() {
        return new MyBean();
    }
}
```

---

## 3. 스프링 빈 스코프의 종류 및 예시
Spring에서는 다음과 같은 **6가지 예약된 스코프 값**을 제공합니다.

### **1. singleton (기본값)**
- **설명:**
  - 애플리케이션당 **하나의 인스턴스**만 생성하여 공유.
  - 동일한 빈을 여러 번 요청해도 같은 객체 반환.
  - 메모리 효율적이며 서비스, DAO에 적합.

- **XML 설정 예시:**
  ```xml
  <bean id="singletonBean" class="com.example.SingletonBean" scope="singleton"/>
  ```

- **Java 설정 예시:**
  ```java
  @Component
  @Scope("singleton")
  public class SingletonBean {}
  ```

- **사용 예:**
  ```java
  SingletonBean s1 = context.getBean("singletonBean", SingletonBean.class);
  SingletonBean s2 = context.getBean("singletonBean", SingletonBean.class);
  System.out.println(s1 == s2);  // true
  ```

---

### **2. prototype**
- **설명:**
  - 요청할 때마다 새로운 객체 생성.
  - 독립적인 상태를 유지해야 하는 경우 유용.

- **XML 설정 예시:**
  ```xml
  <bean id="prototypeBean" class="com.example.PrototypeBean" scope="prototype"/>
  ```

- **Java 설정 예시:**
  ```java
  @Component
  @Scope("prototype")
  public class PrototypeBean {}
  ```

- **사용 예:**
  ```java
  PrototypeBean p1 = context.getBean("prototypeBean", PrototypeBean.class);
  PrototypeBean p2 = context.getBean("prototypeBean", PrototypeBean.class);
  System.out.println(p1 == p2);  // false
  ```

---

### **3. request (웹 애플리케이션용)**
- **설명:**
  - HTTP 요청마다 새로운 인스턴스 생성.
  - Spring MVC 환경에서 사용.

- **Java 설정 예시:**
  ```java
  @RequestScope
  @Component
  public class RequestScopedBean {}
  ```

---

### **4. session (웹 애플리케이션용)**
- **설명:**
  - HTTP 세션마다 하나의 인스턴스 생성.
  - 로그인 사용자별 데이터 저장 등에 적합.

- **Java 설정 예시:**
  ```java
  @SessionScope
  @Component
  public class SessionScopedBean {}
  ```

---

### **5. application (웹 애플리케이션용)**
- **설명:**
  - 서블릿 컨텍스트당 하나의 인스턴스 생성.
  - 애플리케이션 전역적으로 공유되는 리소스에 적합.

- **Java 설정 예시:**
  ```java
  @ApplicationScope
  @Component
  public class ApplicationScopedBean {}
  ```

---

### **6. websocket (웹소켓 연결용)**
- **설명:**
  - 웹소켓 연결당 하나의 인스턴스를 생성.
  - 실시간 상호작용 서비스에 적합.

- **Java 설정 예시:**
  ```java
  @Scope("websocket")
  @Component
  public class WebSocketScopedBean {}
  ```

---

## 4. 프로토타입 스코프의 주의점
- `prototype` 빈은 컨테이너에서 직접 관리되지 않으며, 수명이 애플리케이션 컨텍스트와 다름.
- 빈이 컨테이너에서 제거될 때 **자동으로 소멸되지 않음**, 직접 수명 관리를 해야 함.

```java
PrototypeBean prototype = context.getBean("prototypeBean", PrototypeBean.class);
((ConfigurableApplicationContext) context).close();  // prototype 빈은 제거되지 않음
```

---

## 5. 언제 어떤 스코프를 사용할까?

| 사용 사례                      | 추천 스코프   |
|-------------------------------|---------------|
| 상태가 필요 없는 공통 객체     | singleton     |
| 사용자별 고유 데이터            | session       |
| 요청별 유효한 객체              | request       |
| 새로운 객체가 필요할 때          | prototype     |
| 애플리케이션 전체 공유해야 할 때 | application   |

---

